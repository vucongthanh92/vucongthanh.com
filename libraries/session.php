<?php 

class Session {

//////////////////////////////////////////////////////////////////////
//
// session functions
//
// This is for learning purposes only.
// If you'd like to use it, please 
// let me know before hand.
//

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Start a new session
//
// Syntax: $session = new session();
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function Session() {
	session_start();
}
        
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Set a varible in a current session
//
// Syntax: $session->set_var("Var name", "Value");
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        

function set_var( $varname, $varvalue ) {
	if( !isset($varname) || !isset($varvalue) )
		die("Function set_var( String: " . $varname . ", mixed: " . $varvalue . " ) expects two parameters!");
	if( phpversion() >= "4.1.0" )
		$_SESSION[$varname] = $varvalue;
	if( !isset($GLOBALS[$varname]) )
		$GLOBALS[$varname] = $varvalue;
	else {
		global $HTTP_SESSION_VARS;
		$GLOBALS['HTTP_SESSION_VARS'][$varname] = $varvalue;
			if( !isset($GLOBALS[$varname]) )
				$GLOBALS[$varname] = $varvalue;

			}
	}
        

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Get a varible from a current session
//
// Syntax: $varible = $session->get_var("var name");
// echo "$varible" to get grabbed session varible
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      
function get_var($varname) {
	if( !isset($varname) )
		die("Function getvar( String \$varname ) expects a parameter!");

	if( phpversion() >= "4.1.0" ) { 
		if (isset($GLOBALS[$varname])) 
			return $GLOBALS[$varname];
		elseif (isset($GLOBALS['_SESSION'][$varname])) {
			$GLOBALS[$varname] = $GLOBALS['_SESSION'][$varname];
			return $GLOBALS['_SESSION'][$varname];
		}
	} else {
		if (isset($GLOBALS[$varname])) 
			return $GLOBALS[$varname];
		elseif (isset($GLOBALS['HTTP_SESSION_VARS'][$varname])) {
			$GLOBALS[$varname] = $GLOBALS['HTTP_SESSION_VARS'][$varname];
			return $GLOBALS['HTTP_SESSION_VARS'][$varname];
		}
	}
}
        

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Get a current session string (EXAMPLE: PHPSESSID=b188e8c9c45b347cdded2)
//
// Syntax: $sid = $session->get_sid_string();
// echo "$sid" to grab the string id.  By default it uses PHPSESSID= varible
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function get_sid_string() {
	return session_name() . "=" . session_id();
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Get a current session ID only no varible (EXAMPLE: whatever=b188e8c9c45b347cdded2)
//
// Syntax: $sid = $session->get_sid();
//
// You can now use index.php?id=$sid apose to above using PHPSESSID varible by default
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function get_sid() {
	return session_id();
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Unset a current session varible
//
// Syntax: $session->var_unset("varible name");
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function var_unset( $varname ) {
	if( !isset($varname) )
		die("Function var_unset( String \$varname ) expects a parameter!");

	if( phpversion() >= "4.1.0" ) {
		if (isset($GLOBALS[$varname])) 
			unset( $GLOBALS[$varname] );
	if (isset($GLOBALS['_SESSION'][$varname])) 
		unset( $GLOBALS['_SESSION'][$varname] );
	} else {
		if (isset($GLOBALS[$varname])) 
			unset( $GLOBALS[$varname] );
				if (isset($GLOBALS['HTTP_SESSION_VARS'][$varname])) 
					unset( $GLOBALS['HTTP_SESSION_VARS'][$varname] );
			}
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Unset every varible in the current session 
//
// Syntax: $session->ses_unset();
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function ses_unset() {
	if( phpversion() >= "4.1.0" ) {
		if( isset($GLOBALS['_SESSION']) ) $a = $GLOBALS['_SESSION'];
			while( list($key,) = each($a) )
				$this->var_unset($key);
		} else {
			if( isset($GLOBALS['HTTP_SESSION_VARS']) ) $a = $GLOBALS['HTTP_SESSION_VARS'];
				while( list($key,) = each($a) )
					$this->var_unset($key);
	}
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// This will delete your current session and delete every session varible created
//
// Syntax: $session->destroy();
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function destroy() {
	$this->ses_unset();
	session_destroy();
}
        
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Display all varibles in a current session
//
// Syntax: $session->show();
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function show() {

	echo "<font color=red>Variables set in current session:<br></br></font>\n";

		if( phpversion() >= "4.1.0" ) 
		{
			if( isset($GLOBALS['_SESSION']) ) $a = $GLOBALS['_SESSION'];
				while( list($key,$value) = each($a) )
					echo "<b>Variable:</b> $key - <b>Value:</b> $value<br />\n";
		} else 
		{
			if( isset($GLOBALS['HTTP_SESSION_VARS']) ) $a = $GLOBALS['HTTP_SESSION_VARS'];
				while( list($key,$value) = each($a) )
					echo "<b>Variable:</b> $key - <b>Value:</b> $value<br />\n";
		}
}

}

?>